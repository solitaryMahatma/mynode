# koa2-library-starter

### 介绍

使用 Koa2 搭建后端的脚手架。

---

### 接口概述

- HTTP 状态码
  - `400` 请求的业务被拒绝(一般是参数错误)
  - `401` 鉴权失败
  - `403` 权限不足
  - `404` 请求的资源不存在
  - `413` 请求实体过大
  - `405` 无此方法
  - `500` 服务器挂了
  - `200` 正常请求，返回数据
  - `201` POST 请求正常响应，不返回数据
- 数据响应
  - `errCode` 一定返回，可根据这个判断请求逻辑。具体看 code.md
  - `errMsg` 会在出现异常时，返回异常的具体信息
  - `data` 具体数据

---

### 安装教程

```bash
# 安装
  $ npm i
# 开发
  $ npm run dev
# 生产环境
  $ npm run prod
```

### 使用说明

- global 挂载的变量

  1. `config` src/config 下的所有配置
  2. `Ex` core/httpResponse 下的所有异常类

- ctx 挂载的方法
  1. `success` 用于返回操作成功 http 请求,status:201
  2. `json` 用于返回数据的 http 请求，status:200
  3. `multer` 上传的前置操作。用于解析文件数据，返回文件信息数组。
  4. `valid` 用于检验参数，在 ctx.verify 后调用，如果产生了异常，则自动抛出错误。如果通过，则返回所有参数。
